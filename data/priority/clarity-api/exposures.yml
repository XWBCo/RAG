components:
  schemas:
    ExposuresSecuritiesRequest:
      type: "object"
      properties:
        exposureIds:
          type: "array"
          description: "Requested exposure ids"
          example: "EXP_GMO_PRODUCTS_PART"
          items:
            type: "string"
        securityTypes:
          uniqueItems: true
          type: "array"
          description: "The security types requested"
          example: "FUND"
          items:
            type: "string"
            description: "The security types requested"
            example: "FUND"
            enum:
              - "EQUITY"
              - "FIXED_INCOME"
              - "FUND"
          enum:
            - "EQUITY"
            - "FIXED_INCOME"
            - "FUND"
        securityIdsType:
          type: "string"
          description: "Defines whether the security IDs passed in the 'securityIds' parameter are of type ISIN or CUSIP."
          example: "CUSIP"
          default: "ISIN"
          enum:
            - "ISIN"
            - "CUSIP"
        securityIds:
          uniqueItems: true
          type: "array"
          description: "List of security ids to retrieve"
          example: "US0378331005"
          items:
            type: "string"
            description: "List of security ids to retrieve"
            example: "US0378331005"
        idColumns:
          uniqueItems: true
          type: "array"
          description: "Allows you to specify a list of security ID types that will be included in the response CSV. Only the securities that have an identifier type matching 'idColumns' will be returned. If you want to retrieve all the securities, you can set 'idColumns' to \"ALL\" and no securities will be filtered out. Take into account that when using the \"ALL\" parameter whenever a new security identifier type is available in the Clarity AI platform it will be included in the CSV response."
          example: "CUSIP"
          items:
            type: "string"
            description: "Allows you to specify a list of security ID types that will be included in the response CSV. Only the securities that have an identifier type matching 'idColumns' will be returned. If you want to retrieve all the securities, you can set 'idColumns' to \"ALL\" and no securities will be filtered out. Take into account that when using the \"ALL\" parameter whenever a new security identifier type is available in the Clarity AI platform it will be included in the CSV response."
            example: "CUSIP"
            default: "[\"ISIN\"]"
            enum:
              - "ISIN"
              - "CUSIP"
              - "ALL"
          default:
            - "ISIN"
          enum:
            - "ISIN"
            - "CUSIP"
            - "ALL"
        includeRevenueRange:
          type: "boolean"
          description: "Include minimum and maximum revenue percentages for each exposure in the downloaded file"
          example: true
          default: false
    CreateJobResource:
      type: "object"
      properties:
        uuid:
          type: "string"
    APIError:
      type: "object"
      properties:
        code:
          type: "integer"
          format: "int32"
        message:
          type: "string"
    ExposuresOrganizationsRequest:
      type: "object"
      properties:
        exposureIds:
          type: "array"
          description: "Requested exposure ids"
          example: "EXP_GMO_PRODUCTS_PART"
          items:
            type: "string"
        permIds:
          uniqueItems: true
          type: "array"
          description: "List of organizations, identified by permId, to retrieve information from. If this parameter is not present, all available organizations will be returned"
          example: 5000038958
          items:
            type: "string"
            description: "List of organizations, identified by permId, to retrieve information from. If this parameter is not present, all available organizations will be returned"
            example: "5000038958"
        includeRevenueRange:
          type: "boolean"
          description: "Include minimum and maximum revenue percentages for each exposure in the downloaded file"
          example: true
          default: false
        valueType:
          type: "string"
          description: "Changes the type of the exposure flags returned in the response, from the default boolean values (TRUE/FALSE) to integer values (0/100), where 0 means the company is not exposed and 100 means it is exposed"
          nullable: true
          example: "int"
          default: "boolean"
          enum:
            - "boolean"
            - "int"
    ExposuresOrganizationsRevenueRequest:
      type: "object"
      properties:
        exposureIds:
          type: "array"
          description: "Requested exposure ids"
          example: "EXP_GMO_PRODUCTS_PART"
          items:
            type: "string"
        permIds:
          uniqueItems: true
          type: "array"
          description: "List of organizations, identified by permId, to retrieve information from. If this parameter is not present, all available organizations will be returned"
          example: 5000038958
          items:
            type: "string"
            description: "List of organizations, identified by permId, to retrieve information from. If this parameter is not present, all available organizations will be returned"
            example: "5000038958"
    ExposuresFundsRequest:
      type: "object"
      properties:
        idColumns:
          uniqueItems: true
          type: "array"
          description: "Allows you to specify a list of security ID types that will be included in the response CSV. Only the securities that have an identifier type matching 'idColumns' will be returned. If you want to retrieve all the securities, you can set 'idColumns' to \"ALL\" and no securities will be filtered out. Take into account that when using the \"ALL\" parameter whenever a new security identifier type is available in the Clarity AI platform it will be included in the CSV response."
          example: "CUSIP"
          items:
            type: "string"
            description: "Allows you to specify a list of security ID types that will be included in the response CSV. Only the securities that have an identifier type matching 'idColumns' will be returned. If you want to retrieve all the securities, you can set 'idColumns' to \"ALL\" and no securities will be filtered out. Take into account that when using the \"ALL\" parameter whenever a new security identifier type is available in the Clarity AI platform it will be included in the CSV response."
            example: "CUSIP"
            default: "[\"ISIN\"]"
            enum:
              - "ISIN"
              - "CUSIP"
              - "ALL"
          default:
            - "ISIN"
          enum:
            - "ISIN"
            - "CUSIP"
            - "ALL"
        optionalColumns:
          type: "array"
          description: "Optional columns to return in CSV"
          example: "FUND_GROUP_ID"
          items:
            type: "string"
            description: "Optional columns to return in CSV"
            example: "FUND_GROUP_ID"
            enum:
              - "FUND_GROUP_ID"
          enum:
            - "FUND_GROUP_ID"
        onlyOneSecurityPerFundGroupId:
          type: "boolean"
          description: "Include only one Fund Share Class for each fund group in the response"
          example: true
          default: false
        exposureIds:
          type: "array"
          description: "Requested exposure ids"
          example: "EXP_ALCOHOL_PART"
          items:
            type: "string"
        securityIdsType:
          type: "string"
          description: "Defines whether the security IDs passed in the 'securityIds' parameter are of type ISIN or CUSIP."
          example: "CUSIP"
          default: "ISIN"
          enum:
            - "ISIN"
            - "CUSIP"
        securityIds:
          uniqueItems: true
          type: "array"
          description: "List of security ids to retrieve"
          example: "US0378331005"
          items:
            type: "string"
            description: "List of security ids to retrieve"
            example: "US0378331005"
    PortfolioExposureInfoListResource:
      type: "object"
      properties:
        exposures:
          type: "array"
          items:
            $ref: "#/components/schemas/PortfolioExposureInfoResource"
    PortfolioExposureInfoResource:
      type: "object"
      properties:
        id:
          type: "string"
        category:
          type: "string"
        exposed:
          type: "boolean"
        weightInPortfolio:
          type: "number"
          format: "double"
        treeLevel:
          type: "string"
          enum:
            - "PILLAR"
            - "CATEGORY"
            - "SUBJECT"
    FundsExposureInfoListResource:
      type: "object"
      properties:
        exposures:
          type: "array"
          items:
            $ref: "#/components/schemas/FundExposureInfoResource"
    FundExposureInfoResource:
      type: "object"
      properties:
        id:
          type: "string"
        category:
          type: "string"
        exposed:
          type: "boolean"
        weightInFund:
          type: "number"
          format: "double"
  securitySchemes:
    JWT:
      type: "http"
      scheme: "bearer"
      bearerFormat: "JWT"
info:
  title: "Clarity AI API - Exposures"
  description: "API to access Clarity AI data services."
  termsOfService: "https://static.clarity.ai/Clarity_AI_TermsAndConditions.pdf"
  contact:
    name: "Clarity AI"
    url: "https://www.clarity.ai"
    email: "support@clarity.ai"
  version: "1.0.0"
openapi: "3.0.1"
paths:
  /public/securities/exposures/exposures-by-id/async:
    post:
      tags:
        - "Universe download - Asynchronous jobs"
      summary: "Async Job - Request Securities Exposures"
      description: "This endpoint will make a request for an async job to retrieve the whole universe of <a href=\"https://clarity.ai\">Clarity.AI</a> exposures for given security types (or security ids) and exposure ids.<br>You can ask whether to get securities using securityTypes or provide a list of security ids (usually ISINs) with securityIds, <b>but NOT both</b>.<b>Please note</b>: This call returns only the identifier (UUID) for the created job. You'll need this value later on further calls to know the status of your job (see <a href=\"./asyncjobstatus\">Async Job - Get job status</a>) or download your file when ready (see &laquo;Async Job - Download result file&raquo;)<br>Check <a href=\"/docs/universe-api-async-jobs\">this document</a> for a complete explanation of the flow for these async jobs endpoints"
      operationId: "asyncGetSecuritiesExposures"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExposuresSecuritiesRequest"
        required: true
      responses:
        200:
          description: "The job request has been accepted, UUID follows"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateJobResource"
        400:
          description: "Wrong request parameters:\n\n5002 - List cannot be empty. At least one exposure id is required\n\n5003 - List cannot be empty. At least one security type is required\n\n5005 - List cannot be empty. At least one security ID is required\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it\n\n2201 - Invalid parameters for this request\n\n2202 - The value 'ALL' can not be used in conjunction with other identifier types5006 - Only one of these params can be present: %s. Please provide only one of them\n\n5007 - At least one of these params must be present: %s. Please provide one of them\n\n2203 - 'idColumns' must match 'securityIdTypes' when requesting by specific IDs"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        403:
          description: "Forbidden:\n\n1001 - This account does not have permission to access this resource"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
  /public/organizations/exposures/exposures-by-id/async:
    post:
      tags:
        - "Universe download - Asynchronous jobs"
      summary: "Async Job - Request Organizations Exposures"
      description: "This endpoint will make a request for an async job to retrieve <a href=\"https://clarity.ai\">Clarity.AI</a> organizations exposures for given exposure ids.<br>You can request the whole exposures universe (all organizations) or provide a list of organization permIds (see: <a href=\"https://permid.org/\">permid.org</a>).<b>Please note</b>: This call returns only the identifier (UUID) for the created job. You'll need this value later on further calls to know the status of your job (see <a href=\"./asyncjobstatus\">Async Job - Get job status</a>) or download your file when ready (see &laquo;Async Job - Download result file&raquo;)<br>Check <a href=\"/docs/universe-api-async-jobs\">this document</a> for a complete explanation of the flow for these async jobs endpoints"
      operationId: "asyncGetOrganizationsExposures"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExposuresOrganizationsRequest"
        required: true
      responses:
        200:
          description: "The job request has been accepted, UUID follows"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateJobResource"
        400:
          description: "Wrong request parameters:\n\n2201 - Invalid parameters for this request\n\n5002 - List cannot be empty. At least one exposure id is required\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        403:
          description: "Forbidden:\n\n1001 - This account does not have permission to access this resource"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
  /public/organizations/exposures/exposures-by-id-revenue/async:
    post:
      tags:
        - "Universe download - Asynchronous jobs"
      summary: "Async Job - Request Organizations Revenue Exposures"
      description: "This endpoint will make a request for an async job to retrieve <a href=\"https://clarity.ai\">Clarity.AI</a> organizations revenue exposures for given exposure ids.<br>You can request the whole exposures universe (all organizations) or provide a list of organization permIds (see: <a href=\"https://permid.org/\">permid.org</a>).<b>Please note</b>: This call returns only the identifier (UUID) for the created job. You'll need this value later on further calls to know the status of your job (see <a href=\"./asyncjobstatus\">Async Job - Get job status</a>) or download your file when ready (see &laquo;Async Job - Download result file&raquo;)<br>Check <a href=\"/docs/universe-api-async-jobs\">this document</a> for a complete explanation of the flow for these async jobs endpoints"
      operationId: "asyncGetOrganizationsRevenueExposures"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExposuresOrganizationsRevenueRequest"
        required: true
      responses:
        200:
          description: "The job request has been accepted, UUID follows"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateJobResource"
        400:
          description: "Wrong request parameters:\n\n2201 - Invalid parameters for this request\n\n5002 - List cannot be empty. At least one exposure id is required\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        403:
          description: "Forbidden:\n\n1001 - This account does not have permission to access this resource"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
  /public/funds/exposures/exposures-by-id/async:
    post:
      tags:
        - "Universe download - Asynchronous jobs"
      summary: "Async Job - Request Funds Exposures"
      description: "This endpoint will make a request for an async job to retrieve the whole universe of <a href=\"https://clarity.ai\">Clarity.AI</a> funds exposures for given exposure ids or security ids.<br><b>Please note</b>: This call returns only the identifier (UUID) for the created job. You'll need this value later on further calls to know the status of your job (see <a href=\"./asyncjobstatus\">Async Job - Get job status</a>) or download your file when ready (see &laquo;Async Job - Download result file&raquo;)<br>Check <a href=\"/docs/universe-api-async-jobs\">this document</a> for a complete explanation of the flow for these async jobs endpoints"
      operationId: "asyncGetSecuritiesExposures_1"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ExposuresFundsRequest"
        required: true
      responses:
        200:
          description: "The job request has been accepted, UUID follows"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateJobResource"
        400:
          description: "Wrong request parameters:\n\n5002 - List cannot be empty. At least one exposure id is required\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it\n\n2201 - Invalid parameters for this request\n\n2202 - The value 'ALL' can not be used in conjunction with other identifier types5005 - List cannot be empty. At least one security ID is required\n\n2203 - 'idColumns' must match 'securityIdTypes' when requesting by specific IDs"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        403:
          description: "Forbidden:\n\n1001 - This account does not have permission to access this resource"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
  /public/portfolios/{portfolioId}/exposures/exposures-by-id:
    get:
      tags:
        - "Portfolio Exposures"
      summary: "Get the exposures for the requested portfolio"
      description: "Return the exposures of the portfolio to the requested subjects."
      operationId: "getPortfolioExposures"
      parameters:
        - name: "portfolioId"
          in: "path"
          description: "The portfolio id you are looking for"
          required: true
          schema:
            type: "string"
          example: "9a2f825g00013311c3b93699"
        - name: "subjectId"
          in: "query"
          description: "The exposure subject identifiers"
          required: true
          schema:
            type: "array"
            items:
              type: "string"
          example: "[EXP_COAL_MINING_PART, EXP_TOBACCO_PART]"
      responses:
        200:
          description: "Returns the exposures for the requested portfolio"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PortfolioExposureInfoListResource"
        400:
          description: "Invalid request:\n\n1014 - The data received in the request is not valid\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        403:
          description: "Forbidden:\n\n1001 - This account does not have permission to access this resource"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        404:
          description: "Not found:\n\n2007 - The portfolio id does not exist or does not belong to the user"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
  /public/funds/{isin}/exposures/exposures-by-id:
    get:
      tags:
        - "Fund Exposures"
      summary: "Get specific exposures of the Fund"
      description: "Return the exposures of the fund to the requested subjects."
      operationId: "getFundExposures"
      parameters:
        - name: "isin"
          in: "path"
          description: "The isin the identifies the fund"
          required: true
          schema:
            type: "string"
          example: "LU0000000356"
        - name: "subjectId"
          in: "query"
          description: "The exposure subject identifiers"
          required: true
          schema:
            type: "array"
            items:
              type: "string"
          example: "[EXP_COAL_MINING_PART, EXP_TOBACCO_PART]"
        - name: "fundIdType"
          in: "query"
          description: "Defines if the fund Id in the request is of type ISIN or CUSIP"
          required: false
          schema:
            type: "string"
          example: "ISIN"
      responses:
        200:
          description: "Returns the exposures for the requested Fund"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FundsExposureInfoListResource"
        400:
          description: "Invalid request:\n\n1014 - The data received in the request is not valid\n\n2009 - ISIN not found\n\n2500 - At least one of the exposures requested does not exist or this account does not have permission to access it"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        401:
          description: "Invalid grant:\n\n1000 - Invalid authentication token or expired"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
        404:
          description: "Not found:\n\n2009 - ISIN not found"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/APIError"
      security:
        - JWT: []
servers:
  - url: "https://api.clarity.ai/clarity/v1"
  - url: "https://api.dev.clarity.ai/clarity/v1"
tags:
  - name: "Portfolio Exposures"
    description: "Portfolio Exposures API"
  - name: "Fund Exposures"
    description: "Fund Exposures API"
  - name: "Universe download - Asynchronous jobs"
    description: "Universe download - Asynchronous jobs"
security:
  - JWT: []
